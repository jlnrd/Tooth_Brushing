---
title: "Daily Fluctuations in Teeth Brushing Pilot 4"
output: html_document
---

<style type="text/css">
h1 {
  font-size: 36px;
  margin-top: 60px;
  margin-bottom: 30px;
}

h2 {
  font-size: 28px;

}

h3 {
  font-size: 24px;
  padding-top: 30px;
  margin-bottom: 0px;
  text-align: left !important;
}

h4 {
  font-size: 16px;
}

h5 {
 font-size: 14px;
}

p {
  font-size: 12px;
  text-align: left;
  line-height: 1;
}

h1, h2, h3, h4, h5, h6 {
  text-align: center;
  line-height: 1;
}

.p-text-align-right {
  text-align: right !important;
}

</style>

```{r, include=FALSE,warning=FALSE}
# clean workspace
rm(list=ls())

# load required packages
packages <- c("ggplot2", "ggpubr")
lapply(packages, library, character.only = TRUE)

# standardize ggplot2
theme_set(theme_bw() + theme( plot.title = element_text(size=18, lineheight=1, margin=margin(b=15, t=30), hjust = 0.5),
         axis.title.x = element_text(size=14, lineheight=1, margin=margin(t=15)),
         axis.title.y = element_text(size=14, lineheight=1, margin=margin(r=15))))

##################
## read in data ##
##################
participant_background_information<-read.csv("/Users/appollo_liu/Documents/workspace/Tooth_Brushing/data/parent_q_clean_n19.csv", header=TRUE)
daily_fluctuations<-read.csv("/Users/appollo_liu/Documents/workspace/Tooth_Brushing/data/pilot_041919_merged_n19.csv", header=TRUE)

data<-merge(participant_background_information, daily_fluctuations, by="subject")
# exclude subject 115
data<-data[!grepl(115, data$subject),]

# makes each "key" in the data object its own variable
# Example: data$record_id is now record_id
attach(data)
```

### Subject box plots

```{r,warning=FALSE,fig.width=10, fig.height=8,echo = FALSE}
# plot subject brushing length
brushing_length <- ggplot(data=data, mapping=aes(x=as.factor(subject), y=time_brushing))
brushing_length +
  geom_boxplot() +
  stat_summary(fun.y="mean", geom="point", shape=9, size=3) +
  labs(title="Subject Brushing Length", x="Subject",y="Brushing length (seconds)")
  
# plot subject sleep
sleep_length <- ggplot(data=data, mapping=aes(x=as.factor(subject), y=time_sleep))
sleep_length +
  geom_boxplot() +
  stat_summary(fun.y="mean", geom="point", shape=9, size=3) +
  labs(title="Subject Sleep", x="Subject",y="Sleep (hours)")

# plot subject's parent stress
parent_stress <- ggplot(data=data, mapping=aes(x=as.factor(subject), y=parent_stress))
parent_stress +
  geom_boxplot() +
  stat_summary(fun.y="mean", geom="point", shape=9, size=3) +
  labs(title="Parent Stress", x="Subject",y="Parent stress level")
```

### Relationships between Brushing length, Sleep, and Parent Stress

```{r,warning=FALSE,fig.width=10, fig.height=8,echo = FALSE}
# plot brushing length vs. sleep
brushing_length_vs_sleep <- ggplot(data=data, mapping=aes(x=time_sleep, y=time_brushing, color=as.factor(subject)))
brushing_length_vs_sleep +
  stat_cor(method = "pearson",  size = 6) +
  geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
  geom_point(shape=1) +
  labs(title="Brushing Length vs. Sleep", x="Sleep (hours)", y="Brushing length (seconds)", color="Subject")
  
# plot sleep vs. parent stress
sleep_vs_parent_stress <- ggplot(data=data, mapping=aes(x=parent_stress, y=time_sleep, color=as.factor(subject)))
sleep_vs_parent_stress +
  stat_cor(method = "pearson",  size = 6) +
  geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
  geom_point(shape=1) +
  labs(title="Sleep vs. Parent Stress", x="Parent stress", y="Sleep (hours)", color="Subject")

# plot brushing length vs. parent stress
brushing_length_vs_parent_stress <- ggplot(data=data, mapping=aes(x=parent_stress, y=time_brushing, color=as.factor(subject)))
brushing_length_vs_parent_stress +
  stat_cor(method = "pearson",  size = 6) +
  geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
  geom_point(shape=1) +
  labs(title="Brushing Length vs. Parent Stress", x="Parent stress", y="Brushing length (seconds)", color="Subject")
```

### Daily Fluctuations Correlation Matrix

```{r,warning=FALSE,fig.width=10, fig.height=8,echo = FALSE}
# cbind() combines two matrices that have the same number of rows together
combined_daily_fluctuating_variables<-cbind(time_brushing, encouragement, parent_stress, parent_mood, child_mood, time_sleep, time_sleep_nonap)
```